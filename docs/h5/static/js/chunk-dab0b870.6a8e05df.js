(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dab0b870"],{"27d2":function(t,e,i){"use strict";var a=i("3781"),n=i.n(a);n.a},"28a5":function(t,e,i){"use strict";var a=i("aae3"),n=i("cb7c"),s=i("ebd6"),l=i("0390"),u=i("9def"),r=i("5f1b"),o=i("520a"),c=i("79e5"),p=Math.min,d=[].push,f="split",g="length",h="lastIndex",_=4294967295,v=!c(function(){RegExp(_,"y")});i("214f")("split",2,function(t,e,i,c){var b;return b="c"=="abbc"[f](/(b)*/)[1]||4!="test"[f](/(?:)/,-1)[g]||2!="ab"[f](/(?:ab)*/)[g]||4!="."[f](/(.?)(.?)/)[g]||"."[f](/()()/)[g]>1||""[f](/.?/)[g]?function(t,e){var n=String(this);if(void 0===t&&0===e)return[];if(!a(t))return i.call(n,t,e);var s,l,u,r=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),p=0,f=void 0===e?_:e>>>0,v=new RegExp(t.source,c+"g");while(s=o.call(v,n)){if(l=v[h],l>p&&(r.push(n.slice(p,s.index)),s[g]>1&&s.index<n[g]&&d.apply(r,s.slice(1)),u=s[0][g],p=l,r[g]>=f))break;v[h]===s.index&&v[h]++}return p===n[g]?!u&&v.test("")||r.push(""):r.push(n.slice(p)),r[g]>f?r.slice(0,f):r}:"0"[f](void 0,0)[g]?function(t,e){return void 0===t&&0===e?[]:i.call(this,t,e)}:i,[function(i,a){var n=t(this),s=void 0==i?void 0:i[e];return void 0!==s?s.call(i,n,a):b.call(String(n),i,a)},function(t,e){var a=c(b,t,this,e,b!==i);if(a.done)return a.value;var o=n(t),d=String(this),f=s(o,RegExp),g=o.unicode,h=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(v?"y":"g"),m=new f(v?o:"^(?:"+o.source+")",h),y=void 0===e?_:e>>>0;if(0===y)return[];if(0===d.length)return null===r(m,d)?[d]:[];var C=0,k=0,w=[];while(k<d.length){m.lastIndex=v?k:0;var L,x=r(m,v?d:d.slice(k));if(null===x||(L=p(u(m.lastIndex+(v?0:k)),d.length))===C)k=l(d,k,g);else{if(w.push(d.slice(C,k)),w.length===y)return w;for(var V=1;V<=x.length-1;V++)if(w.push(x[V]),w.length===y)return w;k=C=L}}return w.push(d.slice(C)),w}]})},3781:function(t,e,i){},"55ed":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._m(0),t._v(" "),i("div",{staticClass:"uni-container"},[i("div",{staticClass:"uni-box"},[i("el-table",{attrs:{data:t.tableList.item,border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{align:"center",width:"60",fit:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.$index+1+t.formData.page*t.formData.page_size-t.formData.page_size))]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"页面标题",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.name))]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"页面 URL"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.url))]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary",icon:"el-icon-s-tools"},on:{click:function(i){return t.btnClick(e.row,e)}}},[t._v("编辑规则")])]}}])})],1),t._v(" "),t.tableList.total?i("div",{staticClass:"pagination-box"},[i("el-pagination",{attrs:{background:"","page-size":t.formData.page_size,layout:"sizes,prev, pager, next","current-page":t.formData.page,total:t.tableList.total},on:{"update:currentPage":function(e){return t.$set(t.formData,"page",e)},"update:current-page":function(e){return t.$set(t.formData,"page",e)},"current-change":t.currentChange,"size-change":t.sizeChange}})],1):t._e()],1)]),t._v(" "),i("el-dialog",{attrs:{title:"页面规则",visible:t.dialogTableVisible,"close-on-click-modal":!1,"show-close":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[i("div",{staticClass:"dialog-info"},[i("p",[t._v("页面规则说明：")]),t._v(" "),i("p",[t._v("1. 用于生成内容统计 url 的规则。通过设置页面有效参数，通过带参数的 url 对内容进行标识。例如有一个详情页面的请求有三个参数 page/detail/detail?id=1&type=1&t=1565943419，其中 t 为时间戳或随机数，则 id 和 type 为有效参数，需要在页面规则 page/detail/detail 中添加 id,type 这两个参数。")]),t._v(" "),i("p",[t._v("2. 每条规则可以添加多个参数，进行匹配时，每条规则单独生效。")]),t._v(" "),i("p",[t._v("3. 每个页面可以添加多个规则（最多 5 个规则），进行匹配时，后添加的规则优先级较高")]),t._v(" "),i("p",[t._v("4. 目前的匹配规则只能处理通过 url 显式传递参数，且参数形式为上述示例中的键值对格式。")])]),t._v(" "),i("div",{staticClass:"dialog-wrap"},t._l(t.ruleList,function(e,a){return i("el-row",{key:a,staticClass:"dialog-content",attrs:{gutter:20}},[i("el-col",{attrs:{span:3}},[i("div",{staticClass:"grid-content"},[t._v("规则 "+t._s(t.ruleList.length-a))])]),t._v(" "),i("el-col",{staticClass:"dialog-content-item",attrs:{span:20}},[i("div",{staticClass:"grid-content"}),t._v(" "),t._l(e.dynamicTags,function(e,n){return i("el-tag",{key:n,staticClass:"el-tag-style",attrs:{closable:"","disable-transitions":!1},on:{close:function(i){return t.handleClose(e,a)}}},[t._v(t._s(e))])}),t._v(" "),e.inputVisible?i("el-input",{ref:"saveTagInput"+a,refInFor:!0,staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(e){return t.handleInputConfirm(a)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm(a)}},model:{value:e.inputValue,callback:function(i){t.$set(e,"inputValue",i)},expression:"item.inputValue"}}):i("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(e){return t.showInput(a)}}},[t._v("+ 添加参数")])],2),t._v(" "),i("el-col",{attrs:{span:2}},[0===a&&t.ruleList.length<5?i("i",{staticClass:"el-icon el-icon-circle-plus-outline",on:{click:function(e){return t.add(a)}}}):i("i",{staticClass:"el-icon el-icon-remove-outline",on:{click:function(e){return t.add(a)}}})])],1)}),1),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.closeDialog}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.confirmDialog}},[t._v("确 定")])],1)])],1)},n=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"uni-header"},[i("span",{staticClass:"uni-header__title"},[t._v("页面规则")]),t._v(" "),i("span",{staticClass:"uni-header__title-sub"},[t._v("生成内容统计 url 的规则。通过设置页面有效参数，通过带参数的 url 对内容进行标识")])])}],s=(i("28a5"),i("ac6a"),i("db72")),l=i("2f62"),u={name:"PageRes",data:function(){return{tableList:{},dialogTableVisible:!1,ruleList:[{dynamicTags:["title","id"],inputVisible:!1,inputValue:""}],formData:{id_app:"",id_page:"",page:1,page_size:20}}},computed:Object(s["a"])({},Object(l["b"])(["id_app","p_info"])),watch:{id_app:function(t){t&&(this.formData.id_app=t,this.getBusinessPageRules())}},created:function(){this.formData.id_app=this.id_app,this.formData.p=this.p_info,this.id_app&&this.getBusinessPageRules()},methods:{currentChange:function(t){this.formData.page=t,this.getBusinessPageRules()},sizeChange:function(t){this.formData.page_size=t,this.formData.page=1,this.getActivityDetail()},btnClick:function(t,e){var i=this,a=t.rules,n=t.id_page;if(this.ruleList=[],this.formData.id_page=n,this.index=e.$index,!a)return this.ruleList.unshift({dynamicTags:[],inputVisible:!1,inputValue:""}),void(this.dialogTableVisible=!0);a.forEach(function(t){i.ruleList.unshift({dynamicTags:t.split(","),inputVisible:!1,inputValue:""})}),this.dialogTableVisible=!0},add:function(t){0===t&&this.ruleList.length<5?this.ruleList.unshift({dynamicTags:[],inputVisible:!1,inputValue:""}):this.ruleList.splice(t,1)},handleClose:function(t,e){this.ruleList[e].dynamicTags.splice(this.ruleList[e].dynamicTags.indexOf(t),1)},showInput:function(t){var e=this;this.ruleList[t].inputVisible=!0,this.$nextTick(function(){e.$refs["saveTagInput"+t][0].$refs.input.focus()})},handleInputConfirm:function(t){var e=this.ruleList[t].inputValue;e&&this.ruleList[t].dynamicTags.push(e),this.ruleList[t].inputVisible=!1,this.ruleList[t].inputValue=""},confirmDialog:function(){this.getBusiness_Modify_Page_Rules()},closeDialog:function(){this.dialogTableVisible=!1},getBusinessPageRules:function(){var t=this,e=this.formData,i=e.id_app,a=e.page,n=e.page_size,s={id_app:i,page:a,page_size:n};this.$api.Business_Page_Rules(s).then(function(e){t.tableList=e.data})},getBusiness_Modify_Page_Rules:function(){var t=this,e=this.formData,i=e.id_app,a=e.id_page,n=e.page,s=e.page_size,l={id_app:i,id_page:a,rules:[],page:n,page_size:s},u=[];this.ruleList.forEach(function(t){var e=t.dynamicTags;""!==e.join(",")&&l.rules.push(e.join(","))}),u=l.rules.reverse(),l.rules=JSON.stringify(u),this.$api.Business_Modify_Page_Rules(l).then(function(e){t.tableList.item[t.index].rules=u,t.$message.success("规则保存成功"),t.dialogTableVisible=!1})}}},r=u,o=(i("27d2"),i("2877")),c=Object(o["a"])(r,a,n,!1,null,"46ef4aa6",null);e["default"]=c.exports},aae3:function(t,e,i){var a=i("d3f4"),n=i("2d95"),s=i("2b4c")("match");t.exports=function(t){var e;return a(t)&&(void 0!==(e=t[s])?!!e:"RegExp"==n(t))}}}]);