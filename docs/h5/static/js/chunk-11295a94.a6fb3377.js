(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-11295a94"],{"0f9f":function(t,e,a){"use strict";a.d(e,"b",function(){return i}),a.d(e,"c",function(){return s}),a.d(e,"a",function(){return c});var n=a("ed08"),i={disabledDate:function(t){return Object(n["a"])(Object(n["d"])(new Date,1),Object(n["d"])(t))},shortcuts:[{text:"本周",onClick:function(t){var e=new Date,a=new Date,n=e.getDay()-1;a.setTime(a.getTime()-864e5*n),t.$emit("pick",[a,e])}},{text:"本月",onClick:function(t){var e=new Date,a=new Date,n=e.getDate();a.setTime(a.getTime()-864e5*(n-1)),t.$emit("pick",[a,e])}},{text:"上个月",onClick:function(t){var e=new Date,a=new Date,n=new Date;a.setMonth(a.getMonth()-1),a.setDate(1),e.setMonth(e.getMonth()-1),e.setDate(new Date(n.getFullYear(),n.getMonth(),0).getDate()),t.$emit("pick",[a,e])}},{text:"本季度",onClick:function(t){var e=new Date,a=new Date,n=a.getMonth(),i=0;n<3?i=n:n<6?i=n-3:n<9?i=n-6:n<12&&(i=n-9),a.setMonth(a.getMonth()-i),a.setDate(1),t.$emit("pick",[a,e])}},{text:"本年",onClick:function(t){var e=new Date,a=new Date(e.getFullYear(),0,1);t.$emit("pick",[a,e])}},{text:"去年",onClick:function(t){var e=new Date,a=new Date(e.getFullYear()-1,0,1);e.setFullYear(e.getFullYear()-1),e.setMonth(11),e.setDate(new Date(a.getFullYear()+1,1,0).getDate()),t.$emit("pick",[a,e])}}]},s={disabledDate:function(t){return Object(n["a"])(Object(n["d"])(new Date),Object(n["d"])(t))},shortcuts:[{text:"本周",onClick:function(t){var e=new Date,a=new Date,n=e.getDay()-1;a.setTime(a.getTime()-864e5*n),e.setDate(e.getDate()-1),a.getTime()>e.getTime()&&(a=e),t.$emit("pick",[a,e])}},{text:"本月",onClick:function(t){var e=new Date,a=new Date,n=e.getDate();a.setTime(a.getTime()-864e5*(n-1)),e.setDate(e.getDate()-1),a.getTime()>e.getTime()&&(a=e),t.$emit("pick",[a,e])}},{text:"上个月",onClick:function(t){var e=new Date,a=new Date,n=new Date;a.setMonth(a.getMonth()-1),a.setDate(1),e.setMonth(e.getMonth()-1),e.setDate(new Date(n.getFullYear(),n.getMonth(),0).getDate()),t.$emit("pick",[a,e])}},{text:"本季度",onClick:function(t){var e=new Date,a=new Date,n=a.getMonth(),i=0;n<3?i=n:n<6?i=n-3:n<9?i=n-6:n<12&&(i=n-9),a.setMonth(a.getMonth()-i),a.setDate(1),e.setDate(e.getDate()-1),t.$emit("pick",[a,e])}},{text:"本年",onClick:function(t){var e=new Date,a=new Date(e.getFullYear(),0,1);e.setDate(e.getDate()-1),t.$emit("pick",[a,e])}},{text:"去年",onClick:function(t){var e=new Date,a=new Date(e.getFullYear()-1,0,1);e.setFullYear(e.getFullYear()-1),e.setMonth(11),e.setDate(new Date(a.getFullYear()+1,1,0).getDate()),t.$emit("pick",[a,e])}}]},c={disabledDate:function(t){return Object(n["a"])(Object(n["d"])(new Date),Object(n["d"])(t))},shortcuts:[{text:"本周",onClick:function(t){var e=new Date,a=new Date,n=e.getDay()-1;a.setTime(a.getTime()-864e5*n),t.$emit("pick",[a,e])}},{text:"本月",onClick:function(t){var e=new Date,a=new Date,n=e.getDate();a.setTime(a.getTime()-864e5*(n-1)),t.$emit("pick",[a,e])}},{text:"上个月",onClick:function(t){var e=new Date,a=new Date,n=new Date;a.setMonth(a.getMonth()-1),a.setDate(1),e.setMonth(e.getMonth()-1),e.setDate(new Date(n.getFullYear(),n.getMonth(),0).getDate()),t.$emit("pick",[a,e])}},{text:"本季度",onClick:function(t){var e=new Date,a=new Date,n=a.getMonth(),i=0;n<3?i=n:n<6?i=n-3:n<9?i=n-6:n<12&&(i=n-9),a.setMonth(a.getMonth()-i),a.setDate(1),t.$emit("pick",[a,e])}},{text:"本年",onClick:function(t){var e=new Date,a=new Date(e.getFullYear(),0,1);t.$emit("pick",[a,e])}},{text:"去年",onClick:function(t){var e=new Date,a=new Date(e.getFullYear()-1,0,1);e.setFullYear(e.getFullYear()-1),e.setMonth(11),e.setDate(new Date(a.getFullYear()+1,1,0).getDate()),t.$emit("pick",[a,e])}}]}},"36d1":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uni-user"},[t._m(0),t._v(" "),a("div",{staticClass:"uni-container"},[a("el-row",{staticClass:"uni-box tab"},[a("p",{class:{active:0===t.tabIndex},on:{click:function(e){return t.tab(0,-7)}}},[t._v("最近七天")]),t._v(" "),a("p",{class:{active:1===t.tabIndex},on:{click:function(e){return t.tab(1,-30)}}},[t._v("最近30天")]),t._v(" "),a("p",{class:{active:2===t.tabIndex},on:{click:function(e){return t.tab(2,-90)}}},[t._v("最近90天")])]),t._v(" "),a("el-row",{staticClass:"uni-box navbar"},[a("div",{staticClass:"navbar-box"},[a("el-date-picker",{attrs:{type:"daterange","unlink-panels":"","range-separator":"至",size:"small","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.pickerOptions,"value-format":"yyyy-MM-dd",clearable:!1},on:{change:t.change},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),t._v(" "),a("div",{staticClass:"uni-chats__title-tab"},[a("div",{staticClass:"uni-chats__title-tab-item border",class:{active:1===t.selectIndex},on:{click:function(e){return t.navSelcetTab(1)}}},[t._v("按日")]),t._v(" "),a("div",{staticClass:"uni-chats__title-tab-item",class:{active:2===t.selectIndex},on:{click:function(e){return t.navSelcetTab(2)}}},[t._v("按周")]),t._v(" "),a("div",{staticClass:"uni-chats__title-tab-item",class:{active:3===t.selectIndex},on:{click:function(e){return t.navSelcetTab(3)}}},[t._v("按月")])])],1),t._v(" "),a("div",{staticClass:"navbar-box"},[a("div",{staticClass:"navbar-info"},[a("span",{staticClass:"navbar-info-title"},[t._v("渠道：")]),t._v(" "),a("el-cascader",{attrs:{options:t.channelsOptions,size:"small",clearable:"","show-all-levels":!1},on:{change:function(e){return t.cascaderChange("ch",e)}},model:{value:t.value1,callback:function(e){t.value1=e},expression:"value1"}})],1),t._v(" "),t.versionsShow?a("div",[a("span",{staticClass:"navbar-info-title"},[t._v("版本号：")]),t._v(" "),a("el-cascader",{attrs:{options:t.versionsOptions,size:"small",clearable:"","show-all-levels":!1},on:{change:function(e){return t.cascaderChange("v",e)}},model:{value:t.value2,callback:function(e){t.value2=e},expression:"value2"}})],1):t._e()])]),t._v(" "),a("div",{staticClass:"uni-box"},[a("el-tabs",{on:{"tab-click":t.tabClick}},[a("el-tab-pane",{attrs:{label:"新增留存"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n            新增留存\n            "),a("tips",{attrs:{content:"指定时间新增（即首次访问应用）用户，在之后的第N天，再次访问应用的用户数占比"}})],1)]),t._v(" "),a("el-tab-pane",{attrs:{label:"活跃留存"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n            活跃留存\n            "),a("tips",{attrs:{content:"指定时间活跃（即访问应用）用户，在之后的第N天，再次访问应用的用户数占比"}})],1)])],1),t._v(" "),a("div",{staticClass:"uni-chats__title-tab"},t._l(t.optionsList,function(e,n){return a("div",{key:n,staticClass:"uni-chats__title-tab-item",class:{active:t.navTabIndex===n,border:0===n},on:{click:function(a){return t.navTab(e,n)}}},[t._v(t._s(e.label))])}),0),t._v(" "),0===t.lineChartData.xAxis.length?a("div",{staticClass:"no-data-style"},[t._v("暂无数据")]):a("div",[a("line-chart",{attrs:{"chart-data":t.lineChartData}})],1)],1),t._v(" "),a("div",{staticClass:"uni-box no-padding"},[a("div",{staticClass:"uni-row title"},[a("div",{staticClass:"uni-column"}),t._v(" "),a("div",{staticClass:"uni-column"},[t._v("日期")]),t._v(" "),a("div",{staticClass:"uni-column"},[t._v(t._s("new_visitor"===t.formData.item?"新增":"活跃")+"用户")]),t._v(" "),t._l(t.optionsList,function(e,n){return a("div",{key:n,staticClass:"uni-column"},[t._v(t._s(e.label))])})],2),t._v(" "),t._l(t.list.item,function(e,n){return a("div",{key:n,staticClass:"uni-row"},[a("div",{staticClass:"uni-column"},[t._v(t._s(n+1+t.formData.page*t.formData.page_size-t.formData.page_size))]),t._v(" "),a("div",{staticClass:"uni-column"},[t._v(t._s(e.datetime))]),t._v(" "),a("div",{staticClass:"uni-column"},[t._v(t._s(e.num_visitor))]),t._v(" "),t._l(9,function(n,i){return a("div",{key:i,staticClass:"uni-column",class:{active:e.retention.length>i},style:{background:t.color[e.color[i]]}},[t._v(t._s(e.retention[i])+t._s(e.retention.length>i?"%":""))])})],2)})],2),t._v(" "),t.list.total?a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{background:"","page-size":t.formData.page_size,layout:"sizes,prev, pager, next","current-page":t.formData.page,total:t.list.total},on:{"update:currentPage":function(e){return t.$set(t.formData,"page",e)},"update:current-page":function(e){return t.$set(t.formData,"page",e)},"current-change":t.currentChange,"size-change":t.sizeChange}})],1):t._e()],1)])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uni-header"},[a("span",{staticClass:"uni-header__title"},[t._v("用户留存")]),t._v(" "),a("span",{staticClass:"uni-header__title-sub"},[t._v("用户留存趋势分析")])])}],s=(a("7f7f"),a("ac6a"),a("c5f6"),a("db72")),c=a("2f62"),o=a("0f9f"),r=a("ed08"),l=a("0926"),u=a("efa3"),v={components:{LineChart:l["a"],Tips:u["a"]},data:function(){return{lineChartData:{xAxis:[],series:[]},optionsList:Object(r["e"])(1),pickerOptions:o["c"],channelsOptions:[],versionsOptions:[],value:[Object(r["d"])(new Date,-8),Object(r["d"])(new Date,-1)],value1:["0"],value2:["0"],list:[],formData:{id_app:"",p:0,period:1,ch:0,v:0,start:Object(r["d"])(new Date,-8),end:Object(r["d"])(new Date,-1),item:"new_visitor",rn:1,page:1,page_size:20},versionsShow:!1,navTabIndex:0,selectIndex:1,disabled:1,tabIndex:0,color:["#71b697","#64b691","#5ab78d","#50b788","#42b983"]}},computed:Object(s["a"])({},Object(c["b"])(["id_app","p_info"])),watch:{id_app:function(t){t&&(this.formData.id_app=t,this.value1=["0"],this.value2=["0"],this.formData.ch=0,this.formData.v=0,this.requestInit())},p_info:function(t){this.formData.p=t,1===Number(t)||2===Number(t)?this.versionsShow=!0:this.versionsShow=!1,this.value1=["0"],this.value2=["0"],this.formData.ch=0,this.formData.v=0,this.requestInit()}},created:function(){1===Number(this.formData.p)||2===Number(this.formData.p)?this.versionsShow=!0:this.versionsShow=!1,this.id_app&&(this.formData.id_app=this.id_app,this.formData.p=this.p_info,this.requestInit())},methods:{requestInit:function(){this.formData.page=1,this.getRetentionTrend(),this.getAppChannels(),this.getAppVersions(),this.getRetentionDetail()},tab:function(t,e){this.tabIndex=t,this.formData.start=Object(r["d"])(new Date,e),this.formData.end=Object(r["d"])(new Date,-1),this.value=[this.formData.start,this.formData.end],this.requestInit()},tabClick:function(t){var e=t.index;this.formData.item=0===Number(e)?"new_visitor":"visitor",this.getRetentionTrend(),this.getRetentionDetail()},change:function(t){this.tabIndex=-1,this.formData.period=this.selectIndex,this.formData.start=t[0],this.formData.end=t[1],this.optionsList=Object(r["e"])(this.selectIndex),this.getRetentionTrend(),this.getRetentionDetail()},navTab:function(t,e){this.navTabIndex=e,this.formData.rn=t.value,this.getRetentionTrend()},navSelcetTab:function(t,e){e||(this.selectIndex=t,this.formData.period=this.selectIndex,this.optionsList=Object(r["e"])(this.selectIndex),this.getRetentionTrend(),this.getRetentionDetail())},currentChange:function(t){this.formData.page=t,this.getRetentionDetail()},sizeChange:function(t){this.formData.page_size=t,this.formData.page=1,this.getRetentionDetail()},cascaderChange:function(t,e){"ch"===t?this.formData.ch=e[0]:this.formData.v=e[0],this.requestInit()},getRetentionTrend:function(){var t=this,e=this.formData,a=e.id_app,n=e.p,i=e.period,s=e.ch,c=e.v,o=e.start,r=e.end,l=e.item,u=e.rn,v={id_app:a,p:n,period:i,ch:s,v:c,start:o,end:r,item:l,rn:u};this.$api.Retention_Trend(v).then(function(e){t.lineChartData=e.data})},getAppChannels:function(){var t=this,e=this.formData,a=e.id_app,n=e.p,i={id_app:a,p:n};this.$api.App_Channels(i).then(function(e){var a=e.data,n=[{value:"0",label:"全部"}];a.forEach(function(t){n.push({value:t.id_channel,label:t.name})}),t.channelsOptions=n})},getAppVersions:function(){var t=this,e=this.formData,a=e.id_app,n=e.p,i={id_app:a,p:n};this.$api.App_Versions(i).then(function(e){var a=e.data,n=[{value:"0",label:"全部"}];a.forEach(function(t){n.push({value:t.id_version,label:t.version})}),t.versionsOptions=n})},getRetentionDetail:function(){var t=this,e=this.formData,a=e.id_app,n=e.p,i=e.period,s=e.ch,c=e.v,o=e.start,r=e.end,l=e.item,u=e.rn,v=e.page,h=e.page_size,p={id_app:a,p:n,period:i,ch:s,v:c,start:o,end:r,item:l,rn:u,page:v,page_size:h};this.$api.Retention_Detail(p).then(function(e){t.list=e.data})}}},h=v,p=(a("9704e"),a("2877")),d=Object(p["a"])(h,n,i,!1,null,"368e60df",null);e["default"]=d.exports},"6f00":function(t,e,a){},"9704e":function(t,e,a){"use strict";var n=a("6f00"),i=a.n(n);i.a},ed08:function(t,e,a){"use strict";a.d(e,"d",function(){return s}),a.d(e,"c",function(){return c}),a.d(e,"a",function(){return o}),a.d(e,"e",function(){return r}),a.d(e,"b",function(){return l});a("3b2b"),a("4917"),a("4f7f"),a("5df3"),a("1c4c"),a("ac6a"),a("456d"),a("28a5");var n=a("768b"),i=(a("a481"),a("6b54"),a("7618"));function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"day";"object"!==Object(i["a"])(t)&&(t=t.replace(/-/g,"/"));var n=new Date(t);switch(a){case"day":n.setDate(n.getDate()+e);break;case"month":n.setMonth(n.getMonth()+e);break;case"year":n.setFullYear(n.getFullYear()+e);break}var s=n.getFullYear(),c=n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1,o=n.getDate()<10?"0"+n.getDate():n.getDate();return s+"-"+c+"-"+o}function c(t,e,a){var i=t.split("-"),s=Object(n["a"])(i,3),c=s[0],o=s[1],r=s[2],l=e.split("-"),u=Object(n["a"])(l,3),v=u[0],h=u[1],p=u[2],d=new Date(c,o,r).getTime(),f=new Date(v,h,p).getTime(),D=864e5,g=12096e5,b=2592e6,m=f-d;return a&&0===m?1:m>=b?3:m>=g?2:m>=D?1:0}function o(t,e){return t=new Date(t.replace("-","/").replace("-","/")),e=new Date(e.replace("-","/").replace("-","/")),t<=e}function r(t){var e=[],a="天";switch(t){case 1:a="天";break;case 2:a="周";break;case 3:a="月";break}for(var n=0;n<9;n++){var i=n+1;1===t&&(8===i&&(i=14),9===i&&(i=30)),e.push({value:n+1,label:"".concat(i).concat(a,"后")})}return e}function l(t,e,a){var n,i,s,c,o,r=function r(){var l=+new Date-c;l<e&&l>0?n=setTimeout(r,e-l):(n=null,a||(o=t.apply(s,i),n||(s=i=null)))};return function(){for(var i=arguments.length,l=new Array(i),u=0;u<i;u++)l[u]=arguments[u];s=this,c=+new Date;var v=a&&!n;return n||(n=setTimeout(r,e)),v&&(o=t.apply(s,l),s=l=null),o}}}}]);